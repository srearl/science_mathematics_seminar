<!DOCTYPE html>
<html>
  <head>
    <title>data management, publication, and reproducibility OR reproducibility in science</title>
    <meta charset="utf-8">
    <meta name="date" content="2018-10-31" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="reproducibility_assets/my-theme.css" type="text/css" />
    <link rel="stylesheet" href="libs/remark-css/default-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# data management, publication, and reproducibility OR reproducibility in science
### 2018-10-31

---




let us clarify what we mean by reproducibility...

* Replication is the cornerstone of scientific research, with consistent findings from independent investigators the primary means by which scientific evidence accumulates for or against a hypothesis. 
* The **replicability** of a study is related to the chance that an independent experiment targeting the same scientific question will produce a result consistent with the original study. 
* Recently, a variation of this concept, referred to as reproducibility, has emerged as a key minimum acceptable standard, especially for heavily computational research. 
* **Reproducibility is defined as the ability to recompute data analytic results, given an observed data set and knowledge of the data analysis pipeline.** 
* Replicability and reproducibility are two foundational characteristics of a successful scientific research enterprise. 

.footnote[The reproducibility crisis in science: A statistical counterattack, R. Peng, 10.1111/j.1740-9713.2015.00827.x]


---

a crisis...

&lt;img src="reproducibility_assets/figure-html/reproCrisisPNAS.png" width="100%"&gt;


---

Duke cancer...

.pull-left[
  &lt;img src="reproducibility_assets/figure-html/potti.png" width="100%"&gt;
]

.pull-right[
  &lt;img src="reproducibility_assets/figure-html/baggerly_coombes.png" width="100%"&gt;
]


---

herndon on Reinhart and Rogoff

&lt;img src="reproducibility_assets/figure-html/herndon.png" width="100%"&gt;


---

Cornell

.pull-left[
  &lt;img src="reproducibility_assets/figure-html/wansink.png" width="100%"&gt;
]

.pull-right[
  &lt;img src="reproducibility_assets/figure-html/zeeetal_wansink.png" width="100%"&gt;
]


---

git flow 

&lt;img src="reproducibility_assets/figure-html/git_flow.png" width="100%"&gt;


---

git collaboration

&lt;img src="reproducibility_assets/figure-html/git_collaboration.png" width="100%"&gt;


---

#### reproducability, for scientific reasons

##### given your data, someone else can reproduce your exact results

* increased trustworthiness
* more rigorous, reliable science
* learning more from one another's work

"Science should be 'show me', not 'trust me'; it should be 'help me if you can', not 'catch me if you can'."

*-- Philip B. Stark, &lt;a href="https://www.nature.com/articles/d41586-018-05256-0" target="_blank"&gt;Nature 2018&lt;/a&gt;*
  
  
.footnote[J. Thompson bit.ly/jlt-rmed2018]


---

#### reproducibility, for personal reasons

* "Did I mention that subjects with IDs &gt; 100 are actually kangaroos and should be excluded?"

* "I won the lottery; now my coworker is taking over"

* "Journal reviews back after 8 months! Time for revisions!"

* "How does that patient have 15 months of treatment when we only followed people for 12 months?"
  
.footnote[J. Thompson [bit.ly/jlt-rmed2018](bit.ly/jlt-rmed2018)]


---

#### plan ahead to live your best (research) life

"It's not thinking, 'This is easiest for myself right now.' It's thinking, 'When I'm working on this next week, next month, right before I graduate â€” how do I set myself up so that it's easier later?'

-- Julia Stewart Lowndes in "A toolkit for data transparency takes shape", [Nature 2018](https://www.nature.com/articles/d41586-018-05256-0)
  
.footnote[J. Thompson [bit.ly/jlt-rmed2018](bit.ly/jlt-rmed2018)]


---

#### research data workflow: this is your world (or it will be soon)

&lt;img src="reproducibility_assets/figure-html/workflow.png" width="100%"&gt;

.footnote[J. Bryan from http://stat545.com/]


---

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

* how do you keep that up-to-date?
* what if something changes, what if something needs to be redone - how do you manage that?
* why do the results in table 1 not seem to correspond to the results in figure 1?
* why were those particular samples omitted?
* where did I get these data?
* how did I make that figure?

**basically, if the thought of redoing your analyses is terrifying then you are doing it wrong (paraphrasing Jenny Bryan)**


---

#### research data workflow: this is your world (or it will be soon) - .light-blue[now add to that publishing your data and code]

&lt;img src="reproducibility_assets/figure-html/workflow_with_data.png" width="100%"&gt;

.footnote[J. Bryan from http://stat545.com/]


---

#### what we will cover (okay, touch on) today

* best practices
  + naming
  + organiztion
  + scripting
* spreadsheets
* literate programming
* version control
* getting started
* data management plans
* publishing data


---

#### BP (Best Practice): naming - principles for file names

* machine readable
* human readable
* plays well with default ordering

.footnote[J. Bryan [Naming things](https://speakerdeck.com/jennybc/how-to-name-files)]


---

#### BP: naming - machine readable

* regular expression and globbing friendly
  + avoid spaces, punctuation, accented characters, case sensivity
* easy to compute on with deliberate use of delimiters

example: **"2017-11-17_berneilwash_oxygen_day_1.csv**

underscores allow us to delimit units of metadata and facilitate searching

* easy to search for files later
* easy to narrow file lists based on names
* easy to extract information from the file names, e.g., by splitting
* avoiding spaces, punctuation, accented characters, case sensivity will make your life much easier

.footnote[J. Bryan [Naming things](https://speakerdeck.com/jennybc/how-to-name-files)]


---

#### BP: naming - human readable

* names contain info about the content
* easy to figure out what what something is based on the name

for example **2016_salmon_counts.csv** conveys a lot of information about the object, and has far more meaning than **fishData.csv**

.footnote[J. Bryan [Naming things](https://speakerdeck.com/jennybc/how-to-name-files)]


---

#### BP: naming - names matter in times of stress

which set of file(names)s would you prefer at 3 a.m. before a dealine?

&lt;img src="reproducibility_assets/figure-html/good_bad_names.png" width="80%"&gt;

.footnote[J. Bryan [Naming things](https://speakerdeck.com/jennybc/how-to-name-files)]


---

#### BP: naming - plays well with default ordering

* put something numeric first
* use the ISO 8601 standard for dates (YYYY-MM-DD) everwhere, always without exception ever
* left pad numbers with zeroes as needed

  + 1_file_name.csv
  + 11_file_name.csv
  + 2_file_name.csv
  +       --
  + 01_file_name.csv
  + 02_file_name.csv
  + 11_file_name.csv

.footnote[J. Bryan [Naming things](https://speakerdeck.com/jennybc/how-to-name-files)]


---

#### BP: date format matters (a lot!)

.center[
  &lt;img src="reproducibility_assets/figure-html/noniso.png" width="70%"&gt;
  .small[comprehensive map of all countries in the world that use MMDDYYYY format]
]

use the ISO 8601 standard for dates (YYYY-MM-DD) everwhere, always without exception!

.footnote[J. Bryan [Naming things](https://speakerdeck.com/jennybc/how-to-name-files)]


---

#### BP: employ sound project organization

*your closest collaborator is you six months ago, but you do not reply to emails (K. Broman paraphrasing M. Holder)*

.pull-left[
  &lt;img src="reproducibility_assets/figure-html/projectOrganizationCropped.png" width="80%"&gt;
]

.pull-right[
  .small[
  * segregate all materials for a project in one directory
  * organize according to prevailing conventions (e.g., R package structure)
  * maintain a clear separation of data, method, and output, while unambiguously expressing the relationship between the three
  * specify the computational environment used for the original analysis
  * organize such that another person can know what to expect from the plain meaning of the file and directory names
  * include README files
  ]
]

.footnote[Steps toward reproducible research, K. Broman, [bit.ly/jsm2016](bit.ly/jsm2016)]


---

#### BP: keep the raw data raw

* save the raw data

.footnote[Wilson et al. (2017) Good enough practices in scientific computing. [PLoS Comput Biol13(6): e1005510](https://doi.org/10.1371/journal.pcbi.1005510)]


---

#### BP: thoughtful curation

* curate your data in a way that you would like to receive it

.footnote[Wilson et al. (2017) Good enough practices in scientific computing. [PLoS Comput Biol13(6): e1005510](https://doi.org/10.1371/journal.pcbi.1005510)]


---

#### BP: open file formats

* use open file formats (e.g., csv not xlsx)

.footnote[Wilson et al. (2017) Good enough practices in scientific computing. [PLoS Comput Biol13(6): e1005510](https://doi.org/10.1371/journal.pcbi.1005510)]


---

#### BP: analysis-friendly data

* create analysis-friendly data:
  + each column a variable
  + each row an observation

.pull-left[

 Sepal.Length   Sepal.Width   Petal.Length   Petal.Width  Species 
-------------  ------------  -------------  ------------  --------
          5.1           3.5            1.4           0.2  setosa  
          4.9           3.0            1.4           0.2  setosa  
          4.7           3.2            1.3           0.2  setosa  
          4.6           3.1            1.5           0.2  setosa  
          5.0           3.6            1.4           0.2  setosa  
          5.4           3.9            1.7           0.4  setosa  
]

.pull-right[

Species   metric          value
--------  -------------  ------
setosa    Sepal.Length      5.1
setosa    Sepal.Length      4.9
setosa    Sepal.Length      4.7
setosa    Sepal.Length      4.6
setosa    Sepal.Length      5.0
setosa    Sepal.Length      5.4
setosa    Sepal.Width       3.5
setosa    Sepal.Width       3.0
setosa    Sepal.Width       3.2
setosa    Sepal.Width       3.1
]

.footnote[Wilson et al. (2017) Good enough practices in scientific computing. [PLoS Comput Biol13(6): e1005510](https://doi.org/10.1371/journal.pcbi.1005510)]


---

#### BP: record everything

* record all the steps of the data process


---

#### BP: everything in a script

.light-blue[The most basic principle for reproducible research is: do everything via code]

* downloading data from the web, 
* converting an Excel file to CSV,
* renaming columns or variables, 
* omitting bad samples or data points
* ...do all of these with scripts

You will be tempted to open up a data file and hand-edit. But if you get a revised version of that file, you will need to do it again, and it will be harder to figure out what it was that you did.

Some things are more cumbersome via code but you will save time in the long run.

.footnote[Steps toward reproducible research, K. Broman, [bit.ly/jsm2016](bit.ly/jsm2016)]


---

#### BP: learn a language. any language, just do it

.pull-left[
  &lt;img src="reproducibility_assets/figure-html/rlogo.jpg" width="100%"&gt;
]

.pull-right[
  &lt;img src="reproducibility_assets/figure-html/python-logo.png" width="100%"&gt;
]


---

#### spreadsheets: the dark side

.pull-left[
  &lt;img src="reproducibility_assets/figure-html/excel_errors_wash_post.png" width="50%"&gt;
]


---

#### spreadsheets: the 2nd best tool for everything

.pull-left[
  &lt;img src="reproducibility_assets/figure-html/spreadsheet_hidden_data.png" width="90%"&gt;
]

.pull-right[

  the beauty and the travesty of spreadsheets is that they allow you to do just about anything

      * data in merged cells
      * data in formatting
      * small multiples
      * data in formulas

    use open file formats (e.g., CSV, not XLSX)
]

.footnote[J. Bryan [Spreadsheets](https://speakerdeck.com/jennybc/spreadsheets)]


---

#### spreadsheets versus scripting

consider, we want to remove samples that we feel may have been contaminated...

.pull-left[
  &lt;p&gt;
    &lt;b&gt;in a R script&lt;/b&gt;
  &lt;/p&gt;
  &lt;hr&gt;
  &lt;p&gt;...some work...&lt;/p&gt;
  &lt;p style="margin-bottom:0;"&gt;# remove samples 4, 5, 6, that may&lt;/p&gt;
  &lt;p style="margin-bottom:0;"&gt;# have been compromised due to&lt;/p&gt;
  &lt;p style="margin-bottom:0;"&gt;# wading upstream during sampling&lt;/p&gt;
  &lt;br&gt; 
  &lt;p style="margin-bottom:0;"&gt;chemistry_data %&gt;%
  &lt;p style="margin-bottom:0; text-indent:1em;"&gt;filter(!sample_id %in% c(4,5,6))&lt;/p&gt;
  &lt;br&gt; 
  &lt;p&gt;...more work...&lt;/p&gt;
]

.pull-right[
  &lt;p&gt;
    &lt;b&gt;in a spreadsheet&lt;/b&gt;
  &lt;/p&gt;
  &lt;hr&gt;
  &lt;img src="reproducibility_assets/figure-html/spreadsheet_remove_samples.png" width="90%"&gt;
]

---
&lt;!-- this starts the metadata + publishing lecture --&gt;

#### why publish data

* big picture
  + increasingly a requirement
  + advancement of science
  
* researcher perspective
  + papers with publicly available data receive a higher number of citations than similar studies lacking available data&lt;sup&gt;1&lt;/sup&gt;
  + data sharing is associated with higher productivity&lt;sup&gt;1&lt;/sup&gt;
  + &lt;a href="https://portal.lternet.edu/nis/mapbrowse?packageid=knb-lter-cap.621.1" target="_blank"&gt;a citeable product&lt;/a&gt;
  

.footnote[&lt;sup&gt;1&lt;/sup&gt;[Marwick et al. 2017](https://doi.org/10.7287/peerj.preprints.3192v1)]

---

.pull-left[
  &lt;img src="reproducibility_assets/figure-html/ClimateGate.png" width="100%"&gt;
]

.pull-right[

"The climate scientists at the centre of a media storm over leaked emails were yesterday cleared of accusations that they fudged their results and silenced critics, but a review found they had failed to be open enough about their work."
]

.footnote[https://nceas.github.io/crescynt-training/]


---

#### concerns about sharing data

most common concerns can be addressed *with metadata*

.pull-left[
.center[**concern**]

&lt;hr&gt;

* inappropriate use due to misunderstanding of research purpose or parameters

* security and confidentiality of sensitive data

* lack of acknowledgement / credit

]

.pull-right[
.center[**solution**]

&lt;hr&gt;

* provide rich abstract, purpose, use constraints, and supplemental information

* use constraints to specify who may access the data and how

* specify a required data citation within the use constraints

]

.footnote[https://www.dataone.org/education-modules]


---

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

"Without clear instructions, many researchers struggle to avoid chaos in their file structures, and so are understandably reluctant to expose their workflow for others to see.  This may be one of the reasons that so many requests for details about method, including requests for data and code, are turned down or go unanswered (Collberg &amp; Proebsting 2016)."

.footnote[&lt;sup&gt;1&lt;/sup&gt;[Marwick et al. 2017](https://doi.org/10.7287/peerj.preprints.3192v1)]


---

#### what do we mean by data repository?

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; system &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; long.term &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; versioned &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; citable &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; discoverable &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Google Drive &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; maybe &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; maybe &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; no &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; no &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; GitHub &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; yes &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; yes &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; no &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; no &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; University Server &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; maybe &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; no &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; no &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; maybe &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; KNB* &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; yes &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; yes &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; yes &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; yes &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

.small[*KNB (the Knowledge Network for Biocomplexity) is an international repository intended to facilitate ecological and environmental research]

.footnote[https://nceas.github.io/crescynt-training/]


---

#### where to publish?

.center[
  &lt;img src="reproducibility_assets/figure-html/r3data.png" width="60%"&gt;
]

is wonderful but I would start with...
* institutional resources
* lab, colleagues
* conferences

---

#### metadata standards: there are many

.center[
  &lt;img src="reproducibility_assets/figure-html/metadata_standards_list.png" width="80%"&gt;
]

---

#### metadata standards: what is a standard?

standards provides a structure to describe data with:
- common terms to allow consistency between records
- common definitions for easier interpretation
- common language for ease of communication
- common structure to quickly locate information

in search and retrieval, standards provide:
- documentation structure in a reliable and predictable format for computer interpretation
- a uniform summary description of the dataset

&lt;!-- &lt;p style="color:#00BFFF"&gt;...like a blueprint for the structure of information&lt;/p&gt; --&gt;

.footnote[https://www.dataone.org/education-modules]


---

#### metadata standards: a blueprint

*example for a house*

.pull-left[

house:&lt;br&gt;
&amp;nbsp;parcel_number:&lt;br&gt;
&amp;nbsp;roof:&lt;br&gt;
&amp;nbsp;&amp;nbsp;type: shingle, shake, tile&lt;br&gt;
&amp;nbsp;&amp;nbsp;color:&lt;br&gt;
&amp;nbsp;wall:&lt;br&gt;
&amp;nbsp;&amp;nbsp;exterior_wall:&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;type: block, vinyl, stucco&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;color:&lt;br&gt;
&amp;nbsp;&amp;nbsp;interior_wall:&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;color:&lt;br&gt;

]

.pull-right[

```xml
&lt;house&gt;
  &lt;parcel_number&gt;45.658&lt;/parcel_number&gt;
  &lt;roof&gt;
    &lt;type&gt;tile&lt;/type&gt;
    &lt;color&gt;rustic red&lt;/color&gt;
  &lt;/roof&gt;
  &lt;wall&gt;
    &lt;exterior_wall&gt;
      &lt;type&gt;block&lt;/type&gt;
      &lt;color&gt;swiss coffee&lt;/color&gt;
    &lt;/exterior_wall&gt;
    &lt;interior_wall&gt;
      &lt;color&gt;almond butter&lt;/color&gt;
    &lt;/interior_wall&gt;
 &lt;/wall&gt;
&lt;/house&gt;
```
]


---

#### metadata standards: a blueprint

*example for ecological data*

```xml
&lt;attribute&gt;
  &lt;attributeName&gt;stem_diameter&lt;/attributeName&gt;
  &lt;attributeDefinition&gt;stem diameter&lt;/attributeDefinition&gt;
  &lt;storageType&gt;float&lt;/storageType&gt;
  &lt;measurementScale&gt;
    &lt;ratio&gt;
      &lt;unit&gt;
        &lt;standardUnit&gt;centimeter&lt;/standardUnit&gt;
      &lt;/unit&gt;
      &lt;numericDomain&gt;
        &lt;numberType&gt;real&lt;/numberType&gt;
      &lt;/numericDomain&gt;
    &lt;/ratio&gt;
  &lt;/measurementScale&gt;
  &lt;missingValueCode&gt;
    &lt;code&gt;NA&lt;/code&gt;
    &lt;codeExplanation&gt;missing value&lt;/codeExplanation&gt;
  &lt;/missingValueCode&gt;
&lt;/attribute&gt;
```


---

#### metadata: the who, what, why, where, when

- principal investigator
- funding sources
- data collector/producer
- project description
- sample and sampling procedures
- weighting
- substantive, temporal, and geographic coverage of the data collection
- data source(s)
- unit(s) of analysis/observation
- variables
- technical information on files
- data collection instruments

.footnote[Metadata for Research Data, B. Marshall]


---

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

"data without the contextual information needed to interpret it (and ultimately reproduce the results) is useless"

.footnote[Metadata for Research Data, B. Marshall]


---

#### what makes good metatadata?

- consistency with commonly used fields (e.g., YYYY-MM-DD)
- use a standard vocubulary
- spell out acronyms
- provide all the critical information for: *identification; entities and attributes; data quality; data lineage; access, use, and liability constraints; accessing the data; spatial reference*
- complete title: who, what, when, where, and scale
- be specific, and quantify where possible
- use descriptive and clear writing
- fully document geographic locations
- use keywords wisely (use a thesausus when possible)
- detail, there is no such thing as too much!
- remember that a computer will read this:
  + avoid special characters
  + avoid tabs, indents, carriage returns
  + copy from a text file (not a file with rich text like Word or RTF)


.footnote[https://www.dataone.org/education-modules]

---

#### a special note about titles

.center[
  &lt;img src="reproducibility_assets/figure-html/recently_added_titles.png" width="100%"&gt;
]

---

#### orcid

.center[
&lt;img src="reproducibility_assets/figure-html/orcid.png" width="50%"&gt;
]

[orcid.org](https://orcid.org/)
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
